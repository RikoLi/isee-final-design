# 更新日志

**11.15**

- 算法综述？写需要的算法以及最后选用的？
  - 聚类+分类的方法，定位，按性能做一下对比，有图表
  - 先找个好理解的应用一下，后期再考虑更高级算法
  - 找开源工具
- 做成什么样子，最后产出一个系统化工具？半自动or自动？
  - 确定一个成果构想：算法结果即可
- 论文里面写什么，怎么写？
  - 绪论：意义，研究现状（简单提到即可），章节安排
  - 算法分析：算法具体实现
  - 实验：实现算法，对比效果，分章节写，描述整个过程
  - 总结展望

**12.14**

一些想法：

- 基于分割的方法
  - 基于聚类
    - K-means
    - Meanshift
  - 基于图
    - 最大流/最小割划分
  - 基于特征值分析
    - 图→权重矩阵→特征值分解
- 基于形态学的方法
  - 边缘检测
  - 形状拟合

**12.18**

数据收集，消防箱与水泵：

- 不同光照
- 不同角度
- 不同地点的设备

实现想法：

1. 实现层次化检测：较强低通滤波/降采样（可以加速？），分割，迭代进行，逐渐降低滤波强度至确定开关附近的金属框ROI，最后一个层次下用颜色定位
2. 寻找水泵：颜色+网格特征抽取分类，确定初步ROI；寻找卡口角点，圆形接口拟合

**12.23**

开题中要解决哪些问题，寻找哪些文献？

1. 光照如何补偿？
2. 拍摄角度如何补偿？
3. 基于哪种识别？具体实现参考？

**2.9**

1. 光照补偿尝试同态滤波/HDR merging，HDR需要多张不同曝光时间图像
2. 同态滤波实现参考：https://www.ixueshu.com/document/5dfc6a081c5158da318947a18e7f9386.html

**2.10**

1. 实现了同态滤波，效果一般
2. 尝试对HSV的V进行直方图均衡+中值滤波，亮度调整明显
3. Retinex光照增强暂时不加入，参考：https://www.ixueshu.com/document/15b7e2dc1bc5c37c318947a18e7f9386.html
4. 调整事前registration策略：拍摄正面照+记录开关位置（左右）
5. 开始实现基于形状角的方法，形状角值与文献不太相同？

**2.11**

1. 先检测形状的想法效果不好，改为先色彩聚类，然后分簇拟合
2. 新想法，在registration中记录开关ROI大致位置，透视变换后能直接确定大致位置
3. 重新调整了流程如下（对于开关定位）：
   1. 角度校正
   2. 光照校正：gamma强化hue红色区，抑制其他区
   3. 应用registration：正面照片中定义ROI区域，指出开关所在区域
   4. 初筛：高斯平滑，二值化，确定候选区
   5. fine-tuning：筛选匹配候选区，定位
   
**2.18**

1. 初步实现从消防箱正面图中找到、筛选开关ROI

ROI定位可能存在的问题：

1. 相似色调噪声，需要一种更精细的筛选方式确定候选区

**2.24**

导师反馈意见：

1. 沟通使用doc文档
2. 光照处理建议
   1. 增加光照，而非除去光照，光照波长需试验确定
   2. 对图像进行移动差分处理，类似$I_d(x,y) = I(x+u,y+v)-I(x,y)$
   3. 对灰度图像逐像素非线性映射至更易识别的数据点位

**2.26**

采集了新的消防箱测试照片。

**2.27**

问题：

1. 直接使用ORB特征点/描述子对新测试图像进行修正，发现特征点太少，难以计算透视变换矩阵
2. 对开关红色的识别失败，原因是使用OpenCV的H通道下red range有间断，原先方法无法直接提取连续区间

更新：

1. 为角度修正功能增加新解决方案：FAST特征点+SIFT描述子，解决特征点不足的问题，需要测试更好的角点/描述子组合
2. 将R通道与B通道交换，然后转换至HSV空间，此时原先的red range改变为连续的blue range，可以直接提取

存在的问题：

1. FAST角点使用阈值区分，对噪声高度敏感，进行平滑处理的参数需要微调
2. 可能有更好的角点/描述子组合方式，可进行实验，自变量：角点种类，描述子种类，不同角度的消防箱图像；评价标准：运行速度，角度修正效果
3. 初步试验用FAST角点+SIFT特征，修正效果更好，时间开销较小，后续实验可以记录量化指标
4. 用作registration的正面照在只包含消防箱金属框以内部分的情况下，尽可能大
5. 需要对候选ROI进行筛选，可以基于宽长比初筛

**2.28**

更新：

1. 修复ROI遮罩创建时错位的bug
2. 加入bounding box大小筛选

想法：

1. 用于bounding box筛选的参数是否可以通过统计确定？